(window.webpackJsonpSearchBooster=window.webpackJsonpSearchBooster||[]).push([[6],{46:function(e,t,o){"use strict";o.r(t),o.d(t,"default",(function(){return g}));var n=o(84),r=o.n(n),i=o(5),s=o.n(i),a=o(1),l=o.n(a),c=o(10),u=o(4),p=function(e){var t=null;return e.composed&&e.composedPath&&(t=e.composedPath()[0]),!t&&e.path&&(t=e.path[0]),t||(t=e.target),t},h={},d={},f=300,m=!1,v=document.head,y=document.querySelector('meta[name="viewport"]'),g=function(e){function t(t){var o,n,i;return void 0===t&&(t={}),i=e.call(this,Object.assign(t,{type:"search-popup",modifiers:["combined","fullscreen"]}))||this,l()(r()(i),"addGhostInput",(function(e){var t=document.createElement("input");t.style="display: none",t.classList.add("l-ss-ghost-input-display-none"),e.appendChild(t)})),i.base64=(null==(o=t)||null==(n=o.settings)?void 0:n.base64)||JSON.parse(localStorage.getItem("imageSearchResults")),i.$anchors=[],i}s()(t,e);var o=t.prototype;return o.getVisibleInputInPopUp=function(){var e=!1,t=null;return this.$wrapper.firstChild&&(t=this.$wrapper.firstChild.shadowRoot.querySelector(".l-ss-c-search-input-node"),e=Boolean(t&&t.offsetWidth)),e?t:null},o.focusOnInput=function(e){var t,o=this.getVisibleInputInPopUp()||(null==e?void 0:e.anchor);o&&(""===o.value||null!=(t=this.controller)&&t.configuration.focusOnStartLoad)&&(o.focus(),this.handleShowCompletions())},o.handleShowCompletions=function(){u.a.state.ui.isFiltersOpened||u.a.state.ui.isImageContours||u.a.commit("ui/SET_PROPERTY",{key:"isCompletionsVisible",value:!0})},o.reViewport=function(e){var t,o,n=null==(t=this.controller)||null==(o=t.configuration)?void 0:o.viewPortOptimise;this.newMeta=document.createElement("meta"),this.newMeta.setAttribute("name","viewport"),this.newMeta.setAttribute("content","string"==typeof n?n:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"),"openPopUp"===e?(y&&v.removeChild(y),v.appendChild(this.newMeta)):(this.head=document.querySelector('meta[name="viewport"]'),v.removeChild(this.head),y&&v.appendChild(y))},o.openPopUp=function(e){var t=this;if(!m){var o,n;m=!0,null!=(o=this.controller)&&null!=(n=o.configuration)&&n.viewPortOptimise&&this.reViewport("openPopUp");var r=document.querySelector("body");h.position=window.getComputedStyle(r,null).position,d=r.style.cssText,this.$wrapper.style.display="block",setTimeout((function(){var o=document.querySelectorAll(".l-ss-search-element-mount");o.length>0&&o.forEach((function(e){"input"===e.tagName.toLowerCase()&&e.blur()})),r.classList.add("l-ss-c-popup-is-active"),t.controller.configuration.isPopup&&(r.style.overflow="hidden",t.screen.isMobile&&(r.style.position="fixed",t.controller.configuration.isPopup&&(r.style.overflow="hidden",r.style.position="fixed")),t.focusOnInput(e),e&&t.onSearchChange(e.value))}),200),this.controller.handleUpdateSearchState(),this.controller.publishEvent("popup-open"),this.controller.configuration.isPopup&&this.focusOnInput(e)}},o.closePopUp=function(){var e=this;if(this.controller.configuration.isPopup&&m){var t,o;m=!1;var n=document.querySelector("body");n.classList.remove("l-ss-c-popup-is-active"),n.classList.remove("l-ss-c-body-no-scroll"),this.controller.searchStateManager.clearFromStorage(),this.controller.generateSearchId(),this.controller.publishEvent("popup-close"),n.style.cssText=d,setTimeout((function(){e.setOverflow(),e.$wrapper.style.display="none"}),100),null!=(t=this.controller)&&null!=(o=t.configuration)&&o.viewPortOptimise&&this.reViewport("closePopUp")}},o.searchImageStart=function(e){return new Promise(function(t,o){var n=function(e){return function(t){try{return u.a.commit("ui/SET_PROPERTY",{key:"isImageSearchLoader",value:!1}),e&&e.call(this,t)}catch(e){return o(e)}}.bind(this)}.bind(this),r=function(){try{return t()}catch(e){return o(e)}},i=function(e){try{throw console.error("Image search error",e),e}catch(e){return n(o)(e)}};try{return u.a.commit("ui/SET_PROPERTY",{key:"isImageSearchLoader",value:!0}),Promise.resolve(this.controller.handleImageContours(e)).then(function(t){try{return Promise.resolve(this.controller.handleImageSearch(e)).then((function(e){try{return Promise.resolve(Promise.all([t,e])).then((function(e){try{return u.a.commit("ui/SET_PROPERTY",{key:"isImageSearchVisible",value:!1}),n(r)()}catch(e){return i(e)}}),i)}catch(e){return i(e)}}),i)}catch(e){return i(e)}}.bind(this),i)}catch(e){i(e)}}.bind(this))},o.mount=function(e){var t=this;(this.base64&&this.searchImageStart(this.base64),this.controller.configuration.fixScroll&&!this.screen.isMobile)&&(document.querySelector("html").style.width="100vw");(this.$wrapper=this.createWrapper(),this.controller.configuration.isPopup)?(["string"==typeof e?Array.from(document.querySelectorAll(e)):e].flat().forEach((function(e){return t.$anchors.push(e)})),document.body.appendChild(this.$wrapper)):(("string"==typeof e?document.querySelector(e):e).appendChild(this.$wrapper),this.openPopUp());this.controller.register(this);var o=setInterval((function(){if(t.controller.configuration.isPopup){var n=Array.from(document.querySelectorAll(e))||[e].flat();n.forEach((function(e){e.classList.contains("l-ss-search-element-mount")||(console.warn('SearchBooster widget not found a selector "l-ss-search-element-mount" and repeated the assignment'),e.classList.add("l-ss-search-element-mount"),e.onclick=function(e){"INPUT"!==e.target.tagName&&t.screen.isMobile&&t.addGhostInput(e.target),e.stopPropagation(),t.openPopUp()})})),(f*=2)>6e3&&(n.forEach((function(e){e.classList.contains("l-ss-search-element-mount")||(console.warn('SearchBooster widget not found a selector "l-ss-search-element-mount" in DOM element '+e.tagName+' for mounting!"!'),console.warn(e))})),clearInterval(o))}else clearInterval(o)}),f);return this},o.created=function(){var e=this;this.controller.handleFetchCategories(),this.setOverflow=function(){var t=window.getComputedStyle(document.body);"auto"!==document.body.style.overflow?"hidden"!==t.getPropertyValue("overflow")&&"hidden"!==t.getPropertyValue("overflow-y")||(document.body.style.setProperty("overflow","auto","important"),e.screen.isMobile&&document.body.style.setProperty("position",h.position)):document.body.style.removeProperty("overflow")};if(this.$anchors.forEach((function(t){e.anchorValue=t.value,void 0!==t.value&&(t.value=e.controller.searchStateManager.state.public.query||""),t.classList.add("l-ss-search-element-mount"),t.onclick=function(t){"INPUT"!==t.target.tagName&&e.screen.isMobile&&e.addGhostInput(t.target),t.preventDefault(),t.stopPropagation(),e.openPopUp()}})),!1===this.isCreated){if(this.$el.addEventListener("search-popup-close",(function(){return e.closePopUp()})),this.$el.addEventListener("search-input-change",(function(t){var o=t.detail[0];o&&(m||e.openPopUp()),e.onSearchChange(o)})),this.$el.addEventListener("search-input-focus",(function(){return e.controller.onSearchFocus()})),this.controller.configuration.isPopup){var t=null;document.body.addEventListener("mousedown",(function(){t=new Date})),document.body.addEventListener("click",(function(o){if(o.screenX&&0!==o.screenX&&o.screenY&&0!==o.screenY&&o.target&&(!t||new Date-t<=100)){var n=p(o);n&&n.classList.contains("l-ss-c-host-node")&&e.closePopUp()}})),document.body.addEventListener("mouseup",(function(){setTimeout((function(){t=null}),100)})),this.$wrapper.addEventListener("click",(function(t){t.target.classList.contains("l-ss-c-host-wrapper")&&e.closePopUp()}))}document.addEventListener("keydown",(function(t){var o,n;"Escape"===t.key&&(!e.$wrapper.firstChild||null!=(o=e.controller.configuration)&&null!=(n=o.settings)&&n.widgetComplex||e.$wrapper.firstChild.shadowRoot.querySelector(".l-ss-c-search-popup-close-button").click())}))}window.addEventListener("popstate",(function(){e.controller.searchStateManager.isNotEmpty&&window.location.hash.length?!1===m&&e.openPopUp():e.closePopUp()})),this.controller.searchStateManager.isNotEmpty?setTimeout((function(){e.controller.handleSearch(),e.openPopUp()}),100):this.closePopUp(),this.handleActiveElement=function(){e.$anchors.map((function(t){if(t&&e.controller.configuration.optimizeWidget){if("INPUT"!==t.tagName){var o=t.querySelectorAll("input");o&&o.forEach((function(e){("hidden"!==e.type&&e===document.activeElement||"text"===e.type)&&(t=e)}))}var n={anchor:t,value:e.anchorValue?e.anchorValue:t.value};t!==document.activeElement&&t!==e.activeElement||e.openPopUp(n)}}))},this.handleActiveElement(),this.isCreated=!0},o.onSearchChange=function(e){return"string"!=typeof e?this.controller.handleUpdateSearchState(e):this.controller.handleUpdateSearchState({query:e})},t}(c.default)},84:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}}}]);